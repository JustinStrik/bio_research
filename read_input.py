# in format
""",Cox5a,Atp5d,Apobec3,Cox6c,Ndufa1,Cox7c,Atp5g3,Uqcrb,Ndufs4,Atp5j,Atp5o,Cox7a2l,Atp5b,Atp5a1,Atp5c1,Ndufa4,Cox4i1,Atp5h,Cox8a,Cox6b1,Atp5l,Trir,Cox6a1,Ndufa7,Cox5b,Uqcrh,mt-Co1,mt-Co3,mt-Cytb,Tspan32,Itgb1,Itga6,Cd9,Cd19,Itgb2,Itgb3,Fermt3,Fn1,Rassf5,Sell,Itga4,Tln1,Tyrobp,Itgam,Itgal,Cd226,Vav1,Itga2b,Pik3cd,Prkd2,Selplg,Rap1b,Ptk2b,Rap1a,Alox12,Cyp4f18,Ccm2,Map2k3,Map3k3,Raf1,Akt1,Rhoa,Ywhab,Lsp1,Arrb1,Ywhah,Akt3,Ywhae,Prkcd,Ywhaz,Nfkb1,Prkcb,Arrb2,Ywhaq,Atp5pb,Atp5e,Atp5mpl,mt-Atp8,mt-Atp6,Atp5md,Hnrnpd,Hnrnpk,Hnrnpu,Hnrnpa3,Gm2a,Hexa,Haao,Cat,Cd52,Siglecg,Rpl13,Rps11,Rpl8,Rps9,Rplp1,Rps18,Rpl10,Rps15a,Rps25,Rpl15,Rps5,Rpl19,Rack1,Rps27a,Rps14,Cd74,Rps24,Rps26,Rplp2,Rpl14,Eef1b2,Rps3a1,Rps20,Rps6,Rpl22,Rpl6,Rpl28,Arl6ip1,Rps3,Rps4x,Rpl4,Rpsa,Rps29,Eef2,Serbp1,Rps16,Eef1a1,Rpl10a,Fau,Rpl12,Rps21,Rpl22l1,Rps19,Rpl21,Nop53,Rpl37,Rpl7,Rps2,Rpl18a,Rpl37a,Rpl27a,Rpl9,Rps8,Rpl29,Rps23,Rpl36al,Rps27rt,Rps10,Rpl38,Rpl32,Rpl36,Rpl10-ps3,Rpl23a,Rpl5,Rpl30,Rpl18,Rpl11,Rpl3,Tpt1,Rpl35a,Rpl26,Naca,Rps7,Rps17,Rps12,Rpl34,Rpl17,Rpl7a,Rpl35,Rpl27,Rps15,Rplp0,Rps28,Gm11808,Rpl23,Eef1g,Rpl31,Rpl13a,Gm2000,Eif5a,Rpl36a,Rpl39,Uba52,Rps13,Rpl41,Rpl24,Ddx3x,Eif3a,Birc3,Bcl11a,Arid1a,S100a4,Myh9,Anxa2,Trp53,S100a6,S100a10,Mxd1,Sin3b,Max,Calm1,Myo1c,Calm3,Calm2,Itgb7,Actb,Flna,Actg1,Pfdn5,Cct4,Mef2d,Mef2c,Nfatc3,Nfatc1,Kpnb1,Lbr,Nup153,Tcf25,Vcp,Tubb5,Dync1h1,Tuba1b,Tuba4a,Tubb4b,Tuba1a,Cdkn1b,Stat3,Cyba,Cdc42,Ctnnb1,Ppp2r1a,Pten,Cybb,Ncf1,Hsp90b1,Hsp90aa1,Hsp90ab1,Arhgdia,Ncf2,Hspa5,Itpr1,Iqgap1,Ilk,Ikbkb,Ogt,Mapk14,Gapdh,Mapk1,Ncf4,Capns1,Cast,20240907,Mapk6,20240909,Rac1,Dock2,Ltbp1,Tgfb1,Thbs1,Uba1,Ubc,Ubb,Uba7,Ube2d3,Ube2d2a,Vwf,Pf4,Gp9,Gp5,Gp1ba,Gp6,Idh3g,Ogdh,Bcap31,Fis1,Kmt2a,Crebbp,Kmt2d,Spi1,Irf1,Fos,Runx1,Csf1r,Csf3r,Pml,Rara,Irf8,Stat6,Jak2,Jak1,Il4ra,Il2rg,Napsa,Ctsh,Use1,Stx5a,Puf60,Sf3b1,Fubp1,Sf3b3,Tgfbr2,mt-Nd1,Flii,Lrrfip1,Adgre5,Cd55,Apoe,Clu,Snca,Hp,Sorl1,Prkar2b,Prkar1a,Ccnd3,Skp1a,Rab8a,Rab11a,Sqstm1,Hmgn2,Atp6v1f,Sdha,Atp6v0c,Atp6v0b,Irf3,Tmem173,Ddx58,Ep300,Cd79a,Syk,Ms4a1,Cd22,Btk,Cd79b,Lyn,Blnk,Eif5,Eif3h,Nop56,Eif3c,Eif3f,Eif1,Eif3k,Nsa2,Mrpl33,Man1a,Mgat1,Calr,Canx,Tapbp,Ncl,Pdia3,Tap1,B2m,Btf3,Nr3c1,Stat1,Hdac1,Il21r,Il10ra,Ptpn6,Pecam1,Apbb1ip,Cd72,Sirpa,Pirb,Atp6v1b2,Atp6v0e,Atp6ap1,Rnasek,Cul3,Nedd8,Arih1,Spop,Klhl24,Ppp1cc,Ppp1cb,Ppp1r12c,Ppp1r12a,Myl12a,Rock1,Myl12b,Ppp1r10,Ppp1ca,Myl9,Myl6,Tax1bp1,Gabarap,Itch,Rnf11,Gabarapl2,Arhgef18,Stxbp2,Stx11,Myo5a,Rab11b,Grap,Grb2,Srpk1,Srsf6,Srsf1,Srsf5,Srsf7,Srsf2,Srsf3,Hnrnpa2b1,Ptbp1,Hnrnph1,Hnrnpl,Tra2b,Ybx1,Fus,Tardbp,Hnrnpf,Hnrnpa1,Hnrnpm,Hnrnpc,Cd44,Mmp9,Srgn,Cxcr2,Ptprc,Msn,Pkm,Cxcr4,Cd24a,Ezr,Wdr1,Capzb,Cfl1,Polr2a,Cdk9,Supt4a,Ddb1,Ddx6,Pcf11,Taf10,Setd2,Fcer2a,Cr2,Trim28,Chd3,Eif4g2,Eif4a2,Eif4g1,Eif4a1,Ctcf,Stag2,Psmb4,Psme1,Psmb8,Psma7,Psmd8,Psma3,Psmb3,Tpr,Tpm3,Arpc2,Arpc5,Actr2,Actr3,Arpc5l,Wasf2,Arpc3,Arpc1a,Arpc1b,Brk1,Arpc4,Edf1,Eif3e,Mpl,U2af2,Rac2,Itsn2,Map3k1,Diaph1,Ablim1,Arhgdib,Vasp,Arhgap17,Dock11,Dock10,Dock8,Fmnl1,Wipf1,B4galnt1,Kif5b,Tcf3,Vcl,Csnk2b,Csnk1a1,Ptpn1,Tbl1xr1,Cbl,Arhgap10,Ctbp1,Tcf4,Chd8,Vars,Eef1d,Ppp2r5c,Ppp4r3b,Ppp2r5a,Ppp3ca,Ppp4c,Ppp4r3a,Hspa8,Cct5,Cct8,Cct7,Cct2,Stk24,Tcp1,Pfn1,Arhgef2,Arhgef1,Pkn1,Akap13,Ddx5,Smarca2,Smarcd2,Ctsd,Lamp2,Ctsb,Lamp1,Usp7,Ube2l6,Ube2l3,Ube2v1,Hipk1,Vdac3,Slc25a5,Vdac2,Tspo,Dynll1,Dynlrb1,Ewsr1,Dhx9,Brd4,Brd2,Cdk13,Aff4,Elob,Vps4b,Pdcd6ip,Chmp4b,Nxf1,Ddx39b,Eif4a3,Hnrnpul1,Stx7,Snap23,Tnfrsf13b,Tnfrsf13c,Sumo2,Rbm25,Prpf4b,Sf1,Rbm39,Srrm1,Luc7l2,Rbm5,Srrm2,Prrc2c,Srsf11,Snrnp70,Odc1,Sat1,Oaz1,Inpp5d,Pip4k2a,Plcg2,Pax5,Ets1,Ebf1,Dnajc7,Ndufa3,Ube2i,Rnf4,Actn1,Parvb,Zyx,Actn4,Slamf1,Becn1,Pabpc1,Dnaja1,Dnajb6,Gak,Cers2,Cerk,Sgms1,Capza2,Capza1,Tab2,Ncor1,Nbr1,Map1lc3b,Fli1,Tubb1,mt-Nd2,mt-Nd3,mt-Nd4,mt-Nd5,mt-Nd6,mt-Nd4l,Mapkapk2,Zfp36l1,Atf4,Zfp36,Zfp36l2,H3f3b,H2bc4,Zmynd11,Eed,Atrx,Kat6a,H2az1,Jarid2,Morc3,Bptf,Rbbp4,H4c3,H3f3a,H4c8,Hist1h4n,Hist1h4m,Cyth1,Arf6,Arf1,Ppia,Zfp207,Il1b,Cyth4,H2ac19,H2ac18,Stk4,Mob1a,Papola,Pabpn1,Srsf10,Chd4,Mta2,Tbc1d15,Bnip3l,Ikzf1,Grk2,Adrb2,Cltc,Grk6,Ccl6,Ccl5,Ccr2,Ppm1a,Mff,Mylk,Cald1,Fkbp1a,Nrgn,Fkbp8,Srrt,Snx3,Snx5,Snx2,Rab7,Mical1,Nedd9,Lims1,Rsu1,Tmsb4x,Ifngr1,Ppib,Fgr,Elmo1,Hcls1,Cnot2,Cnot6l,Cnot1,Ldb1,Lmo2,Mknk2,Sptbn1,Sptan1,Mdh1,Acly,Glud1,Cyfip2,Nckap1l,Abi1,Hnrnpab,Edem1,Eif3m,Clk4,Clk1,Ube2b,Rtn4,Rtn3,Nfkbia,Sh3kbp1,Laptm4a,Laptm5,Ap2m1,Eps15,Epn1,Fcho1,Ddx17,Prpf8,Sf3b2,Syf2,Dhx15,Pcbp1,Snrpe,Nme2,Ctps2,Lsm12,Atxn2l,Mia2,Preb,Nfkb2,Ahsa1,Cpsf3,Tmed10,Tmed2,Psenen,Dusp1,Ncoa3,Junb,Jund,Evl,Eif4h,Eif4b,Nup210,Ly86,Cd180,Sema4d,Pik3ap1,Clec1b,Fcer1g,Fcgr3,Cnbp,Mapk8ip3,Myo1f,Map4k4,Atpif1,Hk1,Gls,Glul,Itgb5,Slmap,Fgfr1op2,Cst3,Ctss,Tkt,Tpi1,Taldo1,Pgd,Aldoa,Gpi1,Ldha,Bin1,Mbnl2,Qk,Fyb,Grap2,Skap2,Acin1,Thrap3,Psme2b,Psme3,Psme2,Traf3ip3,Csde1,Derl1,Sod1,Asap1,Arhgef6,Gm49909,Slc38a2,Slc38a1,Ciita,Helz2,Sharpin,Ly6c2,Trip12,Mdm4,Ppil2,Gsn,Dnm2,Son,Il10rb,Txn1,Gpx1,Tubb2a,Bsg,Gnas,Eno1,Nsd3,Stk38,H2-K1,H2-D1,H2-Oa,H2-DMb2,H2-DMa,H2-Ob,H2-Eb1,H2-Ab1,H2-DMb1,Rin3,Mbd2,Fech,Alas2,Slc25a37,H2-Aa,Anxa1,S100a11,Fth1,Ftl1,Ncoa4,Dcaf8,Dcaf12,Trpc4ap,Cop1,Prdx5,Prdx1,Pdcd4,Mxi1,Add3,Epb41,Add1,Tmod3,Rhog,Oga,Gns,Huwe1,Mcl1,Slc25a3,Ifitm1,Cd81,Ifitm3,Smg1,Mkln1,Wdr26,Lgals3,Cd47,Pds5a,Lrrk2,Rb1cc1,Ccpg1,Atg16l2,Cflar,Ppbp,Tgfbi,Sp100,Npm1,Ptprcap,Elk4,Parp1,Cd69,Ccr7,Fcgr2b,Prdx6,Gstp1,Eif2ak3,Gpx4,Caprin1,G3bp2,Cd82,Sord,Gpcpd1,Etnk1,Hmgb1,Snx8,Gnb1,Gnb2,Mbnl1,Notch2,Adam10,Tpm1,Ssh2,Klf2,Sdcbp,Gsr,Txnip,Clta,Hacd4,Tecr,Mier1,Picalm,Ythdc1,Akr1a1,Aldh2,Mtpn,Ptpn12,Pstpip1,Tle3,Arid4b,Rere,Phf21a,Morf4l1,Sfpq,Nono,Matr3,Gnai2,Gng11,Gngt2,Gng5,Klf3,Tec,Tial1,Ep400,Lasp1,S1pr1,Cpsf7,Cbx7,Bpgm,Fcrla,Cxcr5,Gga2,Git2,Malt1,Hbb-bs,Hba-a2,Lsm14a,S100a1,Ahnak,Anp32a,Set,Atp1b3,Atp1a1,Stt3b,Ost4,P2ry12,Rasgrp2,Mga,Med13,Rasgrp3,Uvrag,Rubcn,Sh3glb1,Azin1,R3hdm4,Wtap,H2-Q4,Fbxl5,Kdm2a,Selenof,Selenot,Map4k1,Rapgef6,Bclaf1,Kmt2c,Ubap2l,Lat2,Selenow,Ctla2a,Ctla2b,Pcbp2,Pld4,Cds2,Hba-a1,Hbb-bt,Sipa1,Mrfap1,S100a8,S100a9,Hnrnpr,H2-Q7,H2-Q6,Rrp1,H2-T23,Ptgs1,Gp1bb,Prdx2,Slc4a1,Gypa,Bcl2l1,Ctsz,Tmbim6,Gabarapl1,P2rx1,Pros1,F5,Mif,Cd151,Iscu,Isca1,Tpm2,Uqcr11,Cox7b,Uqcrq,Itga2,C3,Anxa11,Capn2,F10,Cd14,Lcp2,Lat,Ptpn11,Dusp3,P4hb,Socs3,Cebpb,Psap,Grn,Lilrb4a,Cd33,Dhcr24,Mgst1,Vdac1,Ctsc,Ppif,Plin2,Lcn2,Ccr1,Ccl9,Micu1,Smdt1,Xbp1,Pygl,Pgm2l1,Gdi2,Rab6a,Hcst,Sirpb1c,Spcs1,Sec11c,Xdh,Gda,Fpr2,Csf2rb,Plaur,Il1r2,Serpine2,Phospho1,Ptpn22,Csk,Srxn1,G6pdx,Tbxas1,Clec4d,Pgk1,Flot1,Vps25,Mlec,Btla,Mpig6b,Csf2ra,H2-Q10,Vps28,Ssr4,Sec61b,Igtp,Cd59a,Rsad2,Isg15,Ndufa2,Cox7a2,Lgals9,Selp,Ssr3,Cnst,Arhgef12,Dynlt1b,Ankrd28,Ppp6r1,Ctnna1,H4c9,Dad1,Necap2,Sh2b3,Cd59b,Sort1,Ltf,Oasl2,Cd177,Ngp,Camp,Mapk3,Atp6v1g1,Pxn,Pgam1,Gdi1,Rab1b,Tnfrsf1a,Mdh2,Ndufb9,Cfp,Tuba1c,Was,Capn1,Ube2m,Rgs19,Gipc1,App,Rps6ka1,Gm14548,Atp6v0d1,Ppp1r9b,Vamp8,Rab11fip1,Arap3,Ap2s1,Mknk1,Slc9a3r1,Entpd1,Sirpb1b,Glrx,Amfr,Os9,Ly6g,Slc16a3,Twf2,Fpr1,Adpgk,Il1rn,Myd88,Bcl10,Tnfrsf1b,Prex1,Dennd5a,Atp1a3,Tlr13,Unc93b1,Chmp2a,Samd14,Pilra,Mrvi1,Itpr2,Cmah,Cmas,Tcf7,Lars2,Cdc25b,Nr4a1,Col18a1,Hck,Spp1,Uchl1,Cd63,Atxn2,Marcks,Lsm5,Dbi,Rpl7l1,Ube2k,Cd3g,Cd3e,Klf4,Fosb,Egr1,Snrnp200,Cwc15,Lsm2,Snw1,Aar2,Snrpg,Pdia6,Hif1a,Il6st,Cs,Sdhb,Hmgcl,Idh3a,Rrp7a,Eif3l,Ralbp1,Pik3r1,Casp3,Psmd2,Psmd14,Ppih,Ppp2cb,Ulk1,Ppp3r1,Uqcrc2,Ndufs8,Psen2,Ern1,Stip1,Traf2,H2ax,H4c12,Atox1,Cox17,Sparc,Actr1a,Rars,Hspa9,Ero1lb,Vamp2,Top2a,Dlgap5,Eif1a,Ms4a2,Ctsl,Pdhb,Nadk2,Sirt7,Parvg,Twf1,Fyttd1,Sarnp,Ap2b1,Rcan1,Parp3,Mrps23,Mrps21,Anapc4,Shmt2,Clns1a,Col3a1,Xiap,Diablo,Mob4,Rpn2,Anxa5,Polr3gl,Polr3e,Gba2,Asah1,Stmn1,Anapc5,Cyfip1,Cdipt,Mtmr2,Ift57,Nme3,G6pc3,Ssx2ip,Rbmxl1,Fancm,Rab3gap2,Rab18,Hnrnph2,Ddx24,Wdr74,Usp22,Taf9,Ftl1-ps1,Lamtor3,Cd68,Cd36,Rad23a,Ube2c,Pttg1,E2f2,Tfdp2,Glrx5,Kalrn,Aldh1a1,Dhrs3,Lrp1,Aprt,Selenop,Map2k2,Hip1r,Sec61a1,Eif4g3,Cnp,Mbp,Pafah1b1,Irak2,Adcy7,Psmb10,Chkb,Usf1,Usf2,Pnpla7,Pag1,Card11,Ppp1r15a,Mast2,Fkbp5,Ndufb8,Trim25,Icam2,Thy1,Lck,Cd48,Akt2,Map2k1,Mrpl24,Gsdmd,Chtop,Poldip3,Srebf2,Ptpa,Irf9,Stk11,Emg1,Eif3d,Eif3i,Supt5,Ssrp1,Sart1,Phb2,Dlst,Man2b1,Man2c1,Psmd4,Ncoa2,Nr1h2,Napa,Stx4a,Inpp5k,Itpkb,Usp19,Rnf123,Qars,Gatad1,Phf12,Strn4,Wwp2,Inpp4b,Ncor2,Kdm6a,H2bc15,H2bc8,Csnk1d,Trrap,Taok3,Rbck1,Vps16,Lyl1,Fbxl3,Lpin2,Nadk,Hadha,Acox3,Spn,Rasgrp1,Snrpb,Lfng,Dapp1,Scp2,Zbtb7a,Baz2a,Nlrc5,Tnrc6a,Rapgef1,Mtmr3,mt-Co2,Tcirg1,Irf7,Nlrp3,Igf1r,Fosl2,Ets2,Cd300lb,Rgs3,Vpreb3,Pink1,Atp6v1e1,Fcgr4,Lmnb1,Cers6,Cr1l,Vmp1,Dusp6,Dgat1,Sun2,Bcl3,Ppt1,Cln3,Irf5,Cdkn2d,Selenok,Itgb2l,Lilra6,H2bc12,Hk3,Bst1,Pilrb2,Hmgb2,Stfa2,Stfa3,Stfa2l1,Stfa1,Memo1,Uqcr10,Rhob,Alox5,Mapk13,Pik3r5,Il6ra,Pira2,Ppp1r2,Coro1c,Ampd3,Fcho2,Ppp1r15b,Degs1,Clec4e,Mmp25,Pla2g7,Lpcat2,Ehd1,Alas1,Pnpla2,Dgat2,Alox5ap,Soat1,Trem1,Oaz2,Syne1,Rps27,Atp5j2,Bag1,St3gal5,Amd1,Nck2,Gnai3,Ssu72,Arg2,Il1rap,Clec5a,Rgs14,Plxna4,Atp6v0a1,Lta4h,Hmbs,Hist1h2ap,Ubxn6,Cbx3,Ugcg,Gigyf2,Rfk,Blvrb,Arg1,Psma6,Prnp,Lipg
Cox5a,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Atp5d,1,0,0,0,0,0,1,1,0,1,1,0,1,1,1,0,1,1,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Apobec3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Cox6c,1,0,0,0,1,1,0,1,1,1,0,1,0,0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
Ndufa1,1,0,0,1,0,1,0,1,1,0,0,0,0,0,0,"""

import numpy as np
import tensorly as tl
import sparse
# https://tensorly.org/stable/user_guide/sparse_backend.html
from tensorly.contrib.sparse import tensor as sptensor
from tensorly import stack
import pandas as pd
import openpyxl
# import test_alignments from manipulate data folder
from manipulate_data import test_alignments
from get_adj_matrix_files import get_adj_matrix_files, get_edge_list_files

import re

TOTAL_GENES = 1432
TOTAL_WEEKS = 20
TOTAL_WEEKS_WITH_ALIGNMENT = 106

def read_adj_matrix_input(filename, A, mouse_index):
    """
    Read the input adjacency matrix from a file and return it as a numpy array.
    
    Parameters:
    filename (str): The name of the file containing the adjacency matrix.
    A is the 3d array to fill in; Dimensions: TOTAL_GENES, TOTAL_GENES * NUM_MICE, TOTAL_WEEKS
    
    """
    # Read the file and initialize the array
    with open(filename, 'r') as f:
        # Read the first line to get the dimensions of the matrix
        line = f.readline().strip()
        dimensions = len(line.split(',')) - 1

        matrix_week = filename.split("_")[-1].split(".")[0].split('w')[1] # get the week number

        # Initialize the array with zeros
        adj_matrix = np.zeros(shape=(dimensions,dimensions), dtype=bool)

        # Read the rest of the lines to fill in the adjacency matrix, ignoring the first line and the first column
        df = pd.read_csv(filename) 
        # remove first column and row
        df = df.drop(df.columns[0], axis=1)
        df = df.drop(df.index[0])
        # make df tl sparse tensor
        adj_matrix = sptensor(df.values, dtype=bool)

        for i, line in enumerate(f):
            values = line.strip().split(',')[1:]
            # adj_matrix[i] = [int(value) for value in values]
            # make part of with y values start at mouse_index * TOTAL_GENES
            for j, value in enumerate(values):
                adj_matrix[i, mouse_index * TOTAL_GENES + j] = int(value)
                A[i, mouse_index * TOTAL_GENES + j, matrix_week] = int(value)

        # Convert the adjacency matrix to a boolean tensor
        adj_matrix = tl.tensor(adj_matrix, dtype=bool)
        adj_matrix = sparse.COO(adj_matrix)

    return adj_matrix

def read_adj_matrix_input(filename):
    """
    Read the input adjacency matrix from a file and return it as a numpy array.
    
    Parameters:
    filename (str): The name of the file containing the adjacency matrix.
    
    Returns:
    numpy.ndarray: The adjacency matrix read from the file.
    """
    # Read the file and initialize the array
    with open(filename, 'r') as f:
        # Read the first line to get the dimensions of the matrix
        line = f.readline().strip()
        dimensions = len(line.split(',')) - 1

        # Read the rest of the lines to fill in the adjacency matrix, ignoring the first line and the first column
        df = pd.read_csv(filename) 
        # remove first column and row
        df = df.drop(df.columns[0], axis=1)
        df = df.drop(df.index[0])
        # make df tl sparse tensor
        adj_matrix = sptensor(df.values, dtype=bool)

    return adj_matrix

# only have gene names and indices
def make_map_of_genes(filename):
    """
    Read the input adjacency matrix from a file and return it as a numpy array.
    
    Parameters:
    filename (str): The name of the file containing the adjacency matrix.
    
    Returns:
    numpy.ndarray: The adjacency matrix read from the file.
    """
    
    
    # only read first row
    # make map of gene names to indices
    # also make array of gene names

    with open(filename, 'r') as f:
        # Read the first line to get the dimensions of the matrix
        line = f.readline().strip()
        # output first line and int pair to csv file
        genes = line.split(',')[1:] # index to gene name, ignore first column

        gene_to_index = {}

        for i, gene in enumerate(genes):
            gene_to_index[gene] = i

    # write them to file
    with open("gene_to_index.csv", 'w') as f:
        for gene, index in gene_to_index.items():
            f.write(f"{gene},{index}\n")

    return gene_to_index, genes

def get_alignment_matrix():

    alignments = "(-0.030005, -0.08, -0.030004, 0, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.07, -0.030004, 1, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.06, -0.030004, 2, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.05, -0.030004, 3, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.04, -0.030004, 4, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.03, -0.030004, 5, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -0.030007), (-0.030005, -0.02, -0.030004, 6, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, -1e-06, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, -1e-06, 0, -0.030006, -0.030007), (-0.030005, -0.01, -0.030004, 7, -0.030004, -0.030004, -1e-06, -1e-06, -1e-06, -0.030006, 0, -0.030006, -0.030004, -1e-06, -0.030004, -1e-06, 0, 1, -0.030006, -0.030007), (-0.03, 0, -0.03, 8, -0.03, -0.03, 0, 0, 0, -0.03, 1, -0.03, -0.03, 0, -0.03, 0, 1, 2, -0.03, -0.03), (-5e-06, 0.0101, -4e-06, 8.000001, -4e-06, -3e-06, 1, 1, 1e-06, -6e-06, 1.000001, -6e-06, -4e-06, 1e-06, -3e-06, 1, 1.000001, 2.000001, -6e-06, -8e-06), (-0.02, 1, -0.02, 8.0102, -0.02, -0.02, 2, 2, 1, -0.02, 1.0101, -0.02, -0.02, 1, -0.02, 2, 1.0101, 2.0101, -0.02, -0.02), (-4e-06, 1.0101, -3e-06, 8.010203, -3e-06, -2e-06, 3, 2.000001, 1.000001, -5e-06, 1.010103, -5e-06, -3e-06, 1.000001, -2e-06, 2.000001, 1.010103, 2.010103, -5e-06, -7e-06), (-0.01, 2, -0.01, 8.0202, -0.01, -0.01, 4, 3, 2, -0.01, 2, -0.01, -0.01, 2, -0.01, 3, 2, 3, -0.01, -0.01), (-0.009999, 2.0108, -0.009992, 8.020247, -0.009992, -0.009988, 4.000003, 3.000004, 3, -0.009999, 2.000005, -0.009999, -0.009992, 2.000008, 0, 3.000001, 2.000005, 3.00001, -0.009999, -0.009995), (-0.009999, 2.011, -0.009995, 8.020223, -0.009995, 0, 4.000003, 3.000003, 3.000009, -0.009999, 2.000004, -0.009999, -0.009995, 2.000005, 9e-06, 3.000001, 2.000004, 3.000006, -0.009999, -0.009996), (-0.009999, 2.0111, 0, 8.020217, 0, 6e-06, 4.000003, 3.000003, 3.000007, -0.009999, 2.000004, -0.009999, 0, 3, 7e-06, 3.000001, 2.000004, 3.000005, -0.009999, -0.009996), (-0.009999, 2.0113, 5e-06, 8.020235, 5e-06, 8e-06, 5, 3.000003, 3.000012, -0.009999, 2.000004, -0.009999, 5e-06, 3.000005, 1.2e-05, 3.000001, 2.000004, 3.000006, -0.009999, -0.009996), (0, 2.0114, 1e-06, 8.020203, 1e-06, 1e-06, 5.000001, 3.000001, 3.000001, -0.009999, 2.000001, -0.009999, 1e-06, 3.000001, 1e-06, 4, 2.000001, 3.000001, -0.009999, -0.009999), (4e-06, 2.0115, 1.4e-05, 8.020269, 1.4e-05, 1.9e-05, 5.000007, 3.000009, 3.000027, -0.009999, 2.00001, 0, 1.4e-05, 3.000014, 2.7e-05, 4.000004, 2.00001, 3.000017, -0.009999, -0.00999), (1e-06, 2.0116, 8e-06, 8.020253, 8e-06, 1.2e-05, 5.000003, 3.000004, 3.000018, 0, 2.000005, 1e-06, 8e-06, 3.000008, 1.8e-05, 4.000001, 2.000005, 3.00001, 0, -0.009995), (1e-06, 2.0208, 8e-06, 8.020248, 8e-06, 1.2e-05, 5.000003, 3.000004, 4, 1e-06, 2.000005, 1e-06, 8e-06, 3.000008, 1, 4.000001, 2.000005, 3.00001, 1e-06, -0.009995), (1e-06, 2.021, 5e-06, 8.020224, 5e-06, 1, 5.000003, 3.000003, 4.000009, 1e-06, 2.000004, 1e-06, 5e-06, 3.000005, 1.000009, 4.000001, 2.000004, 3.000006, 1e-06, -0.009996), (1e-06, 2.0211, 1, 8.020218, 1, 1.000006, 5.000003, 3.000003, 4.000007, 1e-06, 2.000004, 1e-06, 1, 4, 1.000007, 4.000001, 2.000004, 4, 1e-06, -0.009996), (1e-06, 2.0213, 1.000005, 8.020236, 1.000005, 1.000008, 6, 3.000003, 4.000012, 1e-06, 3, 1e-06, 1.000005, 4.000005, 1.000012, 4.000001, 3, 4.000006, 1e-06, 0), (1, 2.0214, 1.000001, 8.020204, 1.000001, 1.000001, 6.000001, 3.000001, 4.000001, 1e-06, 3.000001, 1e-06, 1.000001, 4.000001, 1.000001, 5, 3.000001, 4.000001, 1e-06, 1e-06), (1.000004, 2.0215, 1.000014, 8.02027, 1.000014, 1.000019, 6.000007, 3.000009, 4.000027, 1e-06, 3.00001, 1, 1.000014, 4.000014, 1.000027, 5.000004, 3.00001, 4.000017, 1e-06, 1e-05), (1.000001, 2.0216, 1.000008, 8.020254, 1.000008, 1.000012, 6.000003, 3.000004, 4.000018, 1, 3.000005, 1.000001, 1.000008, 4.000008, 1.000018, 5.000001, 3.000005, 4.00001, 1, 5e-06), (1.000001, 2.031, 1.000005, 8.020225, 1.000005, 2, 6.000003, 3.000003, 4.000009, 1.000001, 3.000004, 1.000001, 1.000005, 4.000005, 1.000009, 5.000001, 3.000004, 4.000006, 1.000001, 4e-06), (1.000001, 2.0313, 1.000005, 8.020237, 1.000005, 2.000008, 7, 3.000003, 4.000012, 1.000001, 3.000004, 1.000001, 1.000005, 4.000005, 1.000012, 5.000001, 3.000004, 4.000006, 1.000001, 4e-06), (2, 2.0314, 1.000001, 8.020205, 1.000001, 2.000001, 7.000001, 4, 4.000001, 1.000001, 3.000001, 1.000001, 1.000001, 4.000001, 1.000001, 6, 3.000001, 4.000001, 1.000001, 1e-06), (2.000004, 2.0315, 1.000014, 8.020271, 1.000014, 2.000019, 7.000007, 4.000009, 4.000027, 1.000001, 3.00001, 2, 1.000014, 4.000014, 1.000027, 6.000004, 3.00001, 4.000017, 1.000001, 1e-05), (2.000001, 2.0316, 1.000008, 8.020255, 1.000008, 2.000012, 7.000003, 4.000004, 4.000018, 2, 3.000005, 2.000001, 1.000008, 4.000008, 1.000018, 6.000001, 3.000005, 4.00001, 2, 5e-06), (2.000001, 2.0408, 1.000008, 8.020249, 1.000008, 2.000012, 7.000003, 4.000004, 6, 2.000001, 3.000005, 2.000001, 1.000008, 4.000008, 3, 6.000001, 3.000005, 4.00001, 2.000001, 5e-06), (2.000001, 2.041, 1.000005, 8.020226, 1.000005, 3, 7.000003, 4.000003, 6.000009, 2.000001, 3.000004, 2.000001, 1.000005, 4.000005, 3.000009, 6.000001, 3.000004, 4.000006, 2.000001, 4e-06), (2.000001, 2.0413, 1.000005, 8.020238, 1.000005, 3.000008, 8, 4.000003, 6.000012, 2.000001, 4, 2.000001, 1.000005, 4.000005, 3.000012, 6.000001, 4, 4.000006, 2.000001, 1), (3, 2.0414, 1.000001, 8.020206, 1.000001, 3.000001, 8.000001, 4.000001, 6.000001, 2.000001, 4.000001, 2.000001, 1.000001, 4.000001, 3.000001, 7, 4.000001, 4.000001, 2.000001, 1.000001), (3.000004, 2.0415, 2, 8.020272, 2, 3.000019, 8.000007, 4.000009, 6.000027, 2.000001, 4.00001, 3, 2, 5, 3.000027, 7.000004, 4.00001, 4.000017, 2.000001, 1.00001), (3.000001, 2.0416, 2.000008, 8.020256, 2.000008, 3.000012, 8.000003, 4.000004, 6.000018, 3, 4.000005, 3.000001, 2.000008, 5.000008, 3.000018, 7.000001, 4.000005, 4.00001, 3, 1.000005), (3.000001, 2.0508, 2.000008, 8.02025, 2.000008, 3.000012, 8.000003, 4.000004, 7, 3.000001, 4.000005, 3.000001, 2.000008, 5.000008, 4, 7.000001, 4.000005, 4.00001, 3.000001, 1.000005), (3.000001, 2.051, 2.000005, 8.020227, 2.000005, 4, 8.000003, 4.000003, 7.000009, 3.000001, 4.000004, 3.000001, 2.000005, 5.000005, 4.000009, 7.000001, 4.000004, 4.000006, 3.000001, 1.000004), (3.000001, 2.0511, 4, 8.020219, 4, 4.000006, 8.000003, 4.000003, 7.000007, 3.000001, 4.000004, 3.000001, 4, 7, 4.000007, 7.000001, 4.000004, 4.000005, 3.000001, 1.000004), (3.000001, 2.0513, 4.000005, 8.020239, 4.000005, 4.000008, 9, 4.000003, 7.000012, 3.000001, 4.000004, 3.000001, 4.000005, 7.000005, 4.000012, 7.000001, 4.000004, 4.000006, 3.000001, 1.000004), (4, 2.0514, 3, 8.020207, 3, 4.000001, 9.000001, 4.000001, 5, 3.000001, 4.000001, 3.000001, 3, 6, 2, 8, 4.000001, 5, 3.000001, 1.000001), (4.000004, 2.0515, 4.000014, 8.020273, 4.000014, 4.000019, 9.000007, 4.000009, 7.000027, 3.000001, 4.00001, 4, 4.000014, 7.000014, 4.000027, 8.000004, 4.00001, 5.000017, 3.000001, 1.00001), (4.000001, 2.0516, 4.000008, 8.020257, 4.000008, 4.000012, 9.000003, 4.000004, 7.000018, 4, 4.000005, 4.000001, 4.000008, 7.000008, 4.000018, 8.000001, 4.000005, 5.00001, 4, 1.000005), (4.000001, 2.061, 4.000005, 8.020228, 4.000005, 5, 9.000003, 4.000003, 7.000009, 4.000001, 4.000004, 4.000001, 4.000005, 7.000005, 4.000009, 8.000001, 4.000004, 5.000006, 4.000001, 1.000004), (4.000001, 2.0613, 4.000005, 8.02024, 4.000005, 5.000008, 10, 4.000003, 7.000012, 4.000001, 5, 4.000001, 4.000005, 7.000005, 4.000012, 8.000001, 5, 5.000006, 4.000001, 2), (5, 2.0614, 4.000001, 8.020208, 4.000001, 5.000001, 10.000001, 5, 7.000001, 4.000001, 5.000001, 4.000001, 4.000001, 7.000001, 4.000001, 9, 5.000001, 5.000001, 4.000001, 2.000001), (5.000004, 2.0615, 4.000014, 8.020274, 4.000014, 5.000019, 10.000007, 5.000009, 7.000027, 4.000001, 5.00001, 5, 4.000014, 7.000014, 4.000027, 9.000004, 5.00001, 5.000017, 4.000001, 2.00001), (5.000001, 2.0616, 4.000008, 8.020258, 4.000008, 5.000012, 10.000003, 5.000004, 7.000018, 5, 5.000005, 5.000001, 4.000008, 7.000008, 4.000018, 9.000001, 5.000005, 5.00001, 5, 2.000005), (5.000001, 2.0708, 4.000008, 8.020251, 4.000008, 5.000012, 10.000003, 5.000004, 9, 5.000001, 5.000005, 5.000001, 4.000008, 7.000008, 6, 9.000001, 5.000005, 5.00001, 5.000001, 2.000005), (5.000001, 2.071, 4.000005, 8.020229, 4.000005, 6, 10.000003, 5.000003, 9.000009, 5.000001, 5.000004, 5.000001, 4.000005, 7.000005, 6.000009, 9.000001, 5.000004, 5.000006, 5.000001, 2.000004), (5.000001, 2.0711, 6, 8.02022, 6, 6.000006, 10.000003, 5.000003, 9.000007, 5.000001, 5.000004, 5.000001, 6, 9, 6.000007, 9.000001, 5.000004, 5.000005, 5.000001, 2.000004), (6, 2.0714, 6.000001, 8.020209, 6.000001, 6.000001, 10.000001, 5.000001, 9.000001, 5.000001, 5.000001, 5.000001, 6.000001, 9.000001, 6.000001, 10, 5.000001, 5.000001, 5.000001, 2.000001), (6.000004, 2.0715, 6.000014, 8.020275, 6.000014, 6.000019, 10.000007, 5.000009, 9.000027, 5.000001, 5.00001, 6, 6.000014, 9.000014, 6.000027, 10.000004, 5.00001, 5.000017, 5.000001, 2.00001), (6.000001, 2.0716, 6.000008, 8.020259, 6.000008, 6.000012, 10.000003, 5.000004, 9.000018, 6, 5.000005, 6.000001, 6.000008, 9.000008, 6.000018, 10.000001, 5.000005, 5.00001, 6, 2.000005), (6.000001, 2.0808, 6.000008, 8.020252, 6.000008, 6.000012, 10.000003, 5.000004, 10, 6.000001, 5.000005, 6.000001, 6.000008, 9.000008, 7, 10.000001, 5.000005, 5.00001, 6.000001, 2.000005), (6.000001, 2.081, 6.000005, 8.02023, 6.000005, 7, 10.000003, 5.000003, 10.000009, 6.000001, 5.000004, 6.000001, 6.000005, 9.000005, 7.000009, 10.000001, 5.000004, 5.000006, 6.000001, 2.000004), (6.000001, 2.0813, 6.000005, 8.020241, 6.000005, 7.000008, 12, 5.000003, 10.000012, 6.000001, 6, 6.000001, 6.000005, 9.000005, 7.000012, 10.000001, 6, 5.000006, 6.000001, 3), (7, 2.0814, 6.000001, 8.02021, 6.000001, 7.000001, 12.000001, 5.000001, 10.000001, 6.000001, 6.000001, 6.000001, 6.000001, 9.000001, 7.000001, 11, 6.000001, 5.000001, 6.000001, 3.000001), (7.000004, 2.0815, 5, 8.020276, 5, 7.000019, 11, 5.000009, 10.000027, 6.000001, 6.00001, 7, 5, 8, 7.000027, 11.000004, 6.00001, 6, 6.000001, 3.00001), (7.000001, 2.0816, 6.000008, 8.02026, 6.000008, 7.000012, 12.000003, 5.000004, 10.000018, 7, 6.000005, 7.000001, 6.000008, 9.000008, 7.000018, 11.000001, 6.000005, 6.00001, 7, 3.000005), (7.000001, 2.091, 6.000005, 8.020231, 6.000005, 8, 12.000003, 5.000003, 10.00001, 7.000001, 6.000004, 7.000001, 6.000005, 9.000005, 7.00001, 11.000001, 6.000004, 6.000006, 7.000001, 3.000004), (7.000001, 2.0913, 6.000005, 8.020242, 6.000005, 8.000008, 13, 5.000003, 10.000013, 7.000001, 6.000004, 7.000001, 6.000005, 9.000005, 7.000013, 11.000001, 6.000004, 6.000006, 7.000001, 3.000004), (8, 2.0914, 6.000001, 8.020211, 6.000001, 8.000001, 13.000001, 6, 10.000002, 7.000001, 6.000001, 7.000001, 6.000001, 9.000001, 7.000002, 12, 6.000001, 6.000001, 7.000001, 3.000001), (8.000004, 2.0915, 6.000014, 8.020277, 6.000014, 8.000019, 13.000007, 6.000009, 10.000028, 7.000001, 6.00001, 8, 6.000014, 9.000014, 7.000028, 12.000004, 6.00001, 6.000017, 7.000001, 3.00001), (8.000001, 2.0916, 6.000008, 8.020261, 6.000008, 8.000012, 13.000003, 6.000004, 10.000019, 8, 6.000005, 8.000001, 6.000008, 9.000008, 7.000019, 12.000001, 6.000005, 6.00001, 8, 3.000005), (8.000001, 2.101, 6.000005, 8.020232, 6.000005, 9, 13.000003, 6.000003, 10.000011, 8.000001, 6.000004, 8.000001, 6.000005, 9.000005, 7.000011, 12.000001, 6.000004, 6.000006, 8.000001, 3.000004), (8.000001, 2.1011, 9, 8.020221, 9, 9.000006, 13.000003, 6.000003, 10.000007, 8.000001, 6.000004, 8.000001, 9, 12, 7.000007, 12.000001, 6.000004, 8, 8.000001, 3.000004), (8.000001, 2.1013, 9.000005, 8.020243, 9.000005, 9.000008, 14, 6.000003, 10.000014, 8.000001, 7, 8.000001, 9.000005, 12.000005, 7.000014, 12.000001, 7, 8.000006, 8.000001, 4), (9, 2.1014, 7, 8.020212, 7, 9.000001, 14.000001, 6.000001, 8, 8.000001, 7.000001, 8.000001, 7, 10, 5, 13, 7.000001, 7, 8.000001, 4.000001), (9.000004, 2.1015, 9.000014, 8.020278, 9.000014, 9.000019, 14.000007, 6.000009, 10.000029, 8.000001, 7.00001, 9, 9.000014, 12.000014, 7.000029, 13.000004, 7.00001, 8.000017, 8.000001, 4.00001), (9.000001, 2.1016, 9.000008, 8.020262, 9.000008, 9.000012, 14.000003, 6.000004, 10.00002, 9, 7.000005, 9.000001, 9.000008, 12.000008, 7.00002, 13.000001, 7.000005, 8.00001, 9, 4.000005), (9.000001, 2.1111, 10, 8.020222, 10, 9.000007, 14.000003, 6.000003, 10.000008, 9.000001, 7.000004, 9.000001, 10, 13, 7.000008, 13.000001, 7.000004, 8.000005, 9.000001, 4.000004), (9.000001, 2.1113, 10.000005, 8.020244, 10.000005, 9.000009, 15, 6.000003, 10.000015, 9.000001, 7.000004, 9.000001, 10.000005, 13.000005, 7.000015, 13.000001, 7.000004, 8.000007, 9.000001, 4.000004), (10, 2.1114, 10.000001, 8.020213, 10.000001, 9.000002, 15.000001, 6.000001, 10.000003, 9.000001, 7.000001, 9.000001, 10.000001, 13.000001, 7.000003, 14, 7.000001, 8.000001, 9.000001, 4.000001), (10.000004, 2.1115, 10.000014, 8.020279, 10.000014, 9.00002, 15.000007, 6.000009, 10.00003, 9.000001, 7.00001, 10, 10.000014, 13.000014, 7.00003, 14.000004, 7.00001, 8.000018, 9.000001, 4.00001), (10.000001, 2.1116, 10.000008, 8.020263, 10.000008, 9.000013, 15.000003, 6.000004, 10.000021, 10, 7.000005, 10.000001, 10.000008, 13.000008, 7.000021, 14.000001, 7.000005, 8.000011, 10, 4.000005), (10.000001, 2.1213, 10.000006, 8.020245, 10.000006, 9.00001, 16, 6.000003, 10.000016, 10.000001, 8, 10.000001, 10.000006, 13.000006, 7.000016, 14.000001, 8, 8.000008, 10.000001, 5), (11, 2.1214, 10.000002, 8.020214, 10.000002, 9.000003, 16.000001, 7, 10.000004, 10.000001, 8.000001, 10.000001, 10.000002, 13.000002, 7.000004, 15, 8.000001, 8.000002, 10.000001, 5.000001), (11.000004, 2.1215, 8, 8.02028, 8, 9.000021, 16.000007, 7.000009, 10.000031, 10.000001, 8.00001, 11, 8, 11, 7.000031, 15.000004, 8.00001, 8.000019, 10.000001, 5.00001), (11.000001, 2.1216, 10.000009, 8.020264, 10.000009, 9.000014, 16.000003, 7.000004, 10.000022, 11, 8.000005, 11.000001, 10.000009, 13.000009, 7.000022, 15.000001, 8.000005, 8.000012, 11, 5.000005), (11.000001, 2.1313, 10.000007, 8.020246, 10.000007, 9.000011, 17, 7.000003, 10.000017, 11.000001, 8.000004, 11.000001, 10.000007, 13.000007, 7.000017, 15.000001, 8.000004, 8.000009, 11.000001, 5.000004), (12, 2.1314, 10.000003, 8.020215, 10.000003, 9.000004, 17.000001, 7.000001, 10.000005, 11.000001, 8.000002, 11.000001, 10.000003, 13.000003, 7.000005, 16, 8.000002, 8.000003, 11.000001, 5.000002), (12.000004, 2.1315, 10.000015, 8.020281, 10.000015, 9.000022, 17.000007, 7.00001, 10.000032, 11.000001, 8.000011, 12, 10.000015, 13.000015, 7.000032, 16.000004, 8.000011, 8.00002, 11.000001, 5.000011), (12.000001, 2.1316, 10.00001, 8.020265, 10.00001, 9.000015, 17.000003, 7.000005, 10.000023, 12, 8.000006, 12.000001, 10.00001, 13.00001, 7.000023, 16.000001, 8.000006, 8.000013, 12, 5.000006), (13, 2.1414, 10.000004, 8.020216, 10.000004, 9.000005, 17.000002, 7.000002, 10.000006, 12.000001, 8.000003, 12.000001, 10.000004, 13.000004, 7.000006, 17, 8.000003, 8.000004, 12.000001, 5.000003), (13.000004, 2.1415, 10.000016, 8.020282, 10.000016, 9.000023, 17.000008, 7.000011, 10.000033, 12.000001, 8.000012, 13, 10.000016, 13.000016, 7.000033, 17.000004, 8.000012, 8.000021, 12.000001, 5.000012), (13.000001, 2.1416, 10.000011, 8.020266, 10.000011, 9.000016, 17.000004, 7.000006, 10.000024, 13, 8.000007, 13.000001, 10.000011, 13.000011, 7.000024, 17.000001, 8.000007, 8.000014, 13, 5.000007), (13.000005, 2.1515, 10.000017, 8.020383, 10.000017, 9.000024, 17.000009, 7.000012, 10.000034, 13.000001, 8.000013, 14, 10.000017, 13.000017, 7.000034, 17.000005, 8.000013, 8.000022, 13.000001, 5.000013), (13.000002, 2.1516, 10.000012, 8.020367, 10.000012, 9.000017, 17.000005, 7.000007, 10.000025, 14, 8.000008, 14.000001, 10.000012, 13.000012, 7.000025, 17.000002, 8.000008, 8.000015, 14, 5.000008), (13.000003, 2.1616, 10.000013, 8.020468, 10.000013, 9.000018, 17.000006, 7.000008, 10.000026, 15, 8.000009, 14.000002, 10.000013, 13.000013, 7.000026, 17.000003, 8.000009, 8.000016, 15, 5.000009), (14, 3, 11, 9, 11, 10, 18, 8, 11, 16, 9, 15, 11, 14, 8, 18, 9, 9, 16, 6), (14.000006, 3.0103, 11.000006, 9.000001, 11.000003, 10.000006, 18.000006, 8.000002, 11.000006, 16.000006, 9.000006, 15.000003, 11.000006, 15, 8.000003, 18.000006, 9.000003, 9.000003, 16.000003, 7), (14.000001, 3.0105, 11.000001, 10, 11.000001, 10.000001, 18.000001, 8.000001, 11.000001, 16.000001, 9.000001, 15.000001, 11.000001, 15.000001, 8.000001, 18.000001, 9.000001, 9.000001, 16.000001, 7.000001), (14.000002, 3.0205, 11.000002, 11, 11.000001, 10.000002, 18.000002, 9, 11.000002, 16.000002, 9.000002, 15.000001, 11.000002, 15.000001, 8.000001, 18.000002, 9.000001, 9.000001, 16.000001, 7.000001), (14.000007, 3.0303, 11.000007, 11.000001, 11.000003, 10.000007, 18.000007, 9.000002, 11.000007, 16.000007, 9.000007, 15.000003, 11.000007, 17, 8.000003, 18.000007, 9.000003, 9.000003, 16.000003, 9), (14.000003, 3.0305, 11.000003, 12, 12, 10.000003, 18.000003, 9.000001, 11.000003, 16.000003, 9.000003, 16, 11.000003, 16, 9, 18.000003, 10, 10, 17, 8), (14.000004, 3.0405, 11.000004, 13, 12.000001, 10.000004, 18.000004, 10, 11.000004, 16.000004, 9.000004, 16.000001, 11.000004, 17.000001, 9.000001, 18.000004, 10.000001, 10.000001, 17.000001, 9.000001), (14.000005, 3.0505, 11.000005, 14, 12.000002, 10.000005, 18.000005, 10.000001, 11.000005, 16.000005, 9.000005, 16.000002, 11.000005, 17.000002, 9.000002, 18.000005, 10.000002, 10.000002, 17.000002, 9.000002), (14.0101, 4, 12, 15, 13, 11, 18.01, 11, 11.01, 16.01, 10, 17, 11.01, 18, 10, 18.01, 11, 11, 18, 10), (14.010102, 4.0101, 13, 15.000001, 13.000001, 11.000001, 18.010002, 11.000001, 11.010002, 16.010002, 10.000001, 17.000001, 11.010002, 18.000001, 10.000001, 18.010002, 11.000001, 11.000001, 18.000001, 10.000001), (15, 5, 14, 16, 14, 11.01, 18.02, 11.01, 11.02, 16.02, 11, 17.0101, 11.02, 18.01, 10.01, 18.02, 11.01, 11.01, 18.01, 10.0101), (15.000001, 5.0101, 15, 16.000001, 15, 11.010003, 18.020004, 11.010003, 11.020004, 16.020004, 11.000001, 17.010103, 11.020004, 18.010003, 10.010003, 18.020004, 11.010003, 11.010003, 18.010003, 10.010103), (15.0101, 6, 16, 17, 16, 11.02, 18.03, 11.02, 11.03, 16.03, 12, 18, 11.03, 18.02, 10.02, 18.03, 11.02, 11.02, 18.02, 11), (16, 7, 16.01, 18, 16.01, 11.03, 18.04, 11.03, 11.04, 16.04, 12.01, 18.01, 11.04, 18.03, 10.03, 18.04, 11.03, 11.03, 18.03, 11.01)"

    # find indexes of parentheses that have more than 1 integer

    return test_alignments.string_to_2d_array(alignments)

def test_mod(A):

    # change first value in matrix
    A[0,0] = -1

# index is the index of the mouse, alignments is the alignment 2D matrix
def get_week_alignment_for_mouse(mouse_index, alignments):
    # each row is a time, each column is a mouse
    # find values where the column is an integer
    # get the row of the integer
    # make array of them, should return the int->row mapping

    alignment_mapping = {}

    # i is the time (index)
    for i in range(alignments.shape[0]):
        week = alignments[i, mouse_index]
        # week is 3.0 but is not an integer, so we must check if it is an instance of an integer
        if week > 16:
            print("test")
        
        if week.is_integer():
            alignment_mapping[int(week)] = i

    return alignment_mapping

def get_full_matrix(DEBUG_MAX):
    files = get_edge_list_files()
    
    mouse_matrices = []
    mouse_masks = []
    for i, file in enumerate(files):
        if (i >= DEBUG_MAX):
            break
        mouse_matrix, mask = read_edge_list_input(file, i, 1)
        mouse_matrices.append(mouse_matrix)
        mouse_masks.append(mask)

    # stack them all verticallyx
    # mouse_matrices is an array of sparse matrices
    A = np.concatenate(mouse_matrices, axis=1) # axis 1 is vertical
    # do same for masks
    mask = np.concatenate(mouse_masks, axis=1) # this works actually

    return A, mask

def read_edge_list_input(filepath, mouse_index):
    """
    Read the input edge list from a file and return it as a numpy array.
    
    Parameters:
    filename (str): The name of the file containing the edge list. Filetype is .xlsm
    
    Returns:
    numpy.ndarray: The edge list read from the file.
    """
    # Sheet 1 is Week 0, all other sheets are labeled by week, last characters after w is the week number
    # each line is an edge between two genes

    al = get_alignment_matrix()
    # A_time_length = len(al) # length with time alignment separated # change to const TOTAL_WEEKS_WITH_ALIGNMENT

    mouse_alignment = get_week_alignment_for_mouse(mouse_index, al)
    weeks_without_sheets = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]


    with open(filepath, 'r') as f:
        # Read the first line to get the dimensions of the matrix
        # line = f.readline().strip()

        # Read the rest of the lines to fill in the adjacency matrix, ignoring the first line and the first column
        # make the two gene names the indices of the matrix
        # make sparse tensor
        coords_of_edges = [] # list of quadruples of coordinates of edges, (1, gene1, gene2, week), 1 is the value of the edge
        wb = openpyxl.load_workbook(filepath)
        
        # iter over sheets
        for sheet in wb.sheetnames:

            # get the week number
            if sheet == "Sheet1":
                week = 0
            else:
                week = sheet.split('w')[-1]

            print(week)
            week = int(week)
            weeks_without_sheets.remove(week)

            # get the sheet
            ws = wb[sheet]
            # get the values
            for row in ws.iter_rows(min_row=0, max_row=ws.max_row, min_col=0, max_col=2):
                # get the values
                gene1 = row[0].value
                gene2 = row[1].value
                week_index = mouse_alignment[week] # get the index of the week in the alignment matrix
                coords_of_edges.append((1, gene1, gene2, week_index))

    data, x_indices, y_indices, z_indices = zip(*coords_of_edges)
    # convert data to boolean
    data = np.array(data, dtype=bool)
    mouse_3d_matrix = sparse.COO((x_indices, y_indices, z_indices), data=data, shape=(TOTAL_GENES, TOTAL_GENES, TOTAL_WEEKS_WITH_ALIGNMENT))
    # sptensor(data, (x_indices, y_indices, z_indices), shape=(TOTAL_GENES, TOTAL_GENES, TOTAL_WEEKS), dtype=bool)
    # make np sparse tensor

    # init earlier, weeks with sheets, all weeks are present, remove the ones that are not    
    # make remaining weeks NaN
    mask = np.ones((TOTAL_GENES, TOTAL_GENES, TOTAL_WEEKS_WITH_ALIGNMENT), dtype=bool)
    for week in weeks_without_sheets: # will be done later with masking
        mask[:, :, mouse_alignment[week]] = False # 181450, 107850 # mask is 0 where values are missing
        weeks_without_sheets.remove(week)

    return mouse_3d_matrix, mask
    

# extra arg to make it a different function
def read_edge_list_input(filepath, mouse_index, extra_arg):

    al = get_alignment_matrix()
    A_time_length = len(al) # length with time alignment separated

    mouse_alignment = get_week_alignment_for_mouse(mouse_index, al)
    weeks_without_sheets = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18]

    # Read the Excel file into a pandas DataFrame
    wb = openpyxl.load_workbook(filepath)
    coords_of_edges = []

    # Iterate over each sheet in the Excel file
    for sheet in wb.sheetnames:
        # Determine the week number
        if sheet == "Sheet1":
            week = 0
        else:
            week = int(sheet.split('w')[-1])  # Convert week to integer

        # Get the index of the week in the alignment matrix
        week_index = mouse_alignment[week]

        # Get the sheet
        ws = wb[sheet]

        # Iterate over the rows in the sheet
        for row in ws.iter_rows(min_row=0, max_row=ws.max_row, min_col=0, max_col=2):
            gene1 = row[0].value
            gene2 = row[1].value
            coords_of_edges.append((1, gene1, gene2, week_index)) # week index is the index of the week in the alignment matrix

    # Extract the coordinates and data
    data, x_indices, y_indices, z_indices = zip(*coords_of_edges)
    data = np.array(data, dtype=bool)

    # Create the sparse matrix
    mouse_3d_matrix = sparse.COO((x_indices, y_indices, z_indices), data=data, shape=(TOTAL_GENES, TOTAL_GENES, TOTAL_WEEKS_WITH_ALIGNMENT))

    return mouse_3d_matrix, []


if __name__ == "__main__":
    # Test the read_adj_matrix_input function
    filename = "COHP_44940_480__F_B.xlsm"

    adj_matrix = get_full_matrix(2)
    print(adj_matrix)
    # print(adj_matrix.shape)
    
    gene_to_index, genes = make_map_of_genes(filename)
    print(gene_to_index)
    print(genes)

    # output the coordinates of the edges to a file
    with open("full_matrix_with_alignment.csv", "w") as f:
        print("writing to file")

